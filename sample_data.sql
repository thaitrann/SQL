-- CREATE TABLE
CREATE TABLE GIAOVIEN
(
	MAGV VARCHAR(3) PRIMARY KEY NOT NULL,
	HOTEN NVARCHAR(50),
	LUONG FLOAT,
	PHAI NVARCHAR(3),
	NGSINH DATE,
	DIACHI NVARCHAR(100),
	GVQLCM VARCHAR(3),
	MABM NVARCHAR(4)
)

CREATE TABLE KHOA
(
	MAKHOA VARCHAR(4) PRIMARY KEY NOT NULL,
	TENKHOA NVARCHAR(50),
	NAMTL INT,
	PHONG VARCHAR(3),
	DIENTHOAI VARCHAR(10),
	TRUONGKHOA VARCHAR(3),
	NGAYNHANCHUC DATETIME
)

CREATE TABLE BOMON
(
	MABM NVARCHAR(4) PRIMARY KEY NOT NULL,
	TENBM NVARCHAR(50),
	PHONG VARCHAR(3),
	DIENTHOAI VARCHAR(10),
	TRUONGBM VARCHAR(3),
	MAKHOA VARCHAR(4),
	NGAYNHANCHUC DATE
)

CREATE TABLE CHUDE
(
	MACD NVARCHAR(4) PRIMARY KEY NOT NULL,
	TENCD NVARCHAR(50)
)

CREATE TABLE DETAI
(
	MADT VARCHAR(3) PRIMARY KEY NOT NULL,
	TENDT NVARCHAR(50),
	CAPQL NVARCHAR(20),
	KINHPHI FLOAT,
	NGAYBD DATE,
	NGAYKT DATE,
	MACD NVARCHAR(4),
	GVCNDT VARCHAR(3)
)

CREATE TABLE THAMGIADT
(
	MAGV VARCHAR(3),
	MADT VARCHAR(3),
	STT INT,
	PHUCAP DECIMAL(5,1),
	KETQUA NVARCHAR(10),
	PRIMARY KEY (MAGV, MADT, STT)
)

CREATE TABLE CONGVIEC
(
	MADT VARCHAR(3),
	SOTT INT,
	TENCV NVARCHAR(50),
	NGAYBD DATETIME,
	NGAYKT DATETIME,
	PRIMARY KEY (MADT, SOTT)
)

CREATE TABLE NGUOITHAN
(
	MAGV VARCHAR(3),
	TEN NVARCHAR(12),
	NGSINH DATETIME,
	PHAI NVARCHAR(3),
	PRIMARY KEY (MAGV, TEN)
)

CREATE TABLE GV_DT
(
	MAGV VARCHAR(3),
	DIENTHOAI VARCHAR (10),
	PRIMARY KEY (MAGV, DIENTHOAI)
)

-- INSERT DATA

-- CHUDE
INSERT INTO CHUDE
	(MACD, TENCD)
VALUES
	('NCPT', N'NGHIÊN CỨU PHÁT TRIỂN'),
	('QLGD', N'QUẢN LÝ GIÁO DỤC'),
	('UDCN', N'ỨNG DỤNG CÔNG NGHỆ')

-- GIAOVIEN
INSERT INTO GIAOVIEN
	(MAGV, HOTEN, LUONG, PHAI, NGSINH, DIACHI, GVQLCM, MABM)
VALUES
	('001', N'NGUYỄN HOÀI AN', 2000.0, N'NAM', '1973-02-15', N'25/3 LẠC LONG QUÂN, Q.10,TP HCM', NULL, N'MMT'),
	('002', N'TRẦN TRÀ HƯƠNG', 2500.0, N'NỮ', '1960-06-20', N'125 TRẦN HƯNG ĐẠO, Q.1, TP HCM', NULL, N'HTTT'),
	('003', N'NGUYỄN NGỌC ÁNH', 2200.0, N'NỮ', '1975-05-11', N'12/21 VÕ VĂN NGÂN THỦ ĐỨC, TP HCM', N'002', N'HTTT'),
	('004', N'TRƯƠNG NAM SƠN', 2300.0, N'NAM', '1959-06-20', N'215 LÝ THƯỜNG KIỆT,TP BIÊN HÒA', NULL, N'VS'),
	('005', N'LÝ HOÀNG HÀ', 2500.0, N'NAM', '1954-10-23', N'22/5 NGUYỄN XÍ, Q.BÌNH THẠNH, TP HCM', NULL, N'VLĐT'),
	('006', N'TRẦN BẠCH TUYẾT', 1500.0, N'NỮ', '1980-05-20', N'127 HÙNG VƯƠNG, TP MỸ THO', N'004', N'VS'),
	('007', N'NGUYỄN AN TRUNG', 2100.0, N'NAM', '1976-06-05', N'234 3/2, TP BIÊN HÒA', NULL, N'HPT'),
	('008', N'TRẦN TRUNG HIẾU', 1800.0, N'NAM', '1977-08-06', N'22/11 LÝ THƯỜNG KIỆT,TP MỸ THO', N'007', N'HPT'),
	('009', N'TRẦN HOÀNG NAM', 2000.0, N'NAM', '1975-11-22', N'234 TRẤN NÃO,AN PHÚ, TP HCM', N'001', N'MMT'),
	('010', N'PHẠM NAM THANH', 1500.0, N'NAM', '1980-12-12', N'221 HÙNG VƯƠNG,Q.5, TP HCM', N'007', N'HPT')


-- KHOA
INSERT INTO KHOA
	(MAKHOA, TENKHOA, NAMTL, PHONG, DIENTHOAI, TRUONGKHOA, NGAYNHANCHUC)
VALUES
	(N'CNTT', N'CÔNG NGHỆ THÔNG TIN', 1995, 'B11', '0838123456', '002', '2005-02-20'),
	(N'HH', N'HÓA HỌC', 1980, 'B41', '0838456456', '007', '2001-10-15'),
	(N'SH', N'SINH HỌC', 1980, 'B31', '0838454545', '004', '2000-10-11'),
	(N'VL', N'VẬT LÝ', 1976, 'B21', '0838223223', '005', '2003-09-18')

-- BOMON
INSERT INTO BOMON
	(MABM, TENBM, PHONG, DIENTHOAI, TRUONGBM, MAKHOA, NGAYNHANCHUC)
VALUES
	(N'CNTT', N'CÔNG NGHỆ TRI THỨC', 'B15', '0838126126', NULL, N'CNTT', NULL),
	(N'HHC', N'HÓA HỮU CƠ', 'B44', '0838222222', NULL, N'HH', NULL),
	(N'HL', N'HÓA LÝ', 'B42', '0838878787', NULL, N'HH', NULL),
	(N'HPT', N'HÓA PHÂN TÍCH', 'B43', '0838777777', '007', N'HH', '2007-10-15'),
	(N'HTTT', N'HỆ THỐNG THÔNG TIN', 'B13', '0838125125', '002', N'CNTT', '2004-09-20'),
	(N'MMT', N'MẠNG MÁY TÍNH', 'B16', '0838676767', '001', N'CNTT', '2005-05-15'),
	(N'SH', N'SINH HÓA', 'B33', '0838898989', NULL, N'SH', NULL),
	(N'VLĐT', N'VẬT LÝ ĐIỆN TỬ', 'B23', '0838234234', NULL, N'VL', NULL),
	(N'VLUD', N'VẬT LÝ ỨNG DỤNG', 'B24', '0838454545', '005', N'VL', '2006-02-18'),
	(N'VS', N'VI SINH', 'B32', '0838909090', '004', N'SH', '2007-01-01')

-- GV_DT
INSERT INTO GV_DT
	(MAGV,DIENTHOAI)
VALUES
	('001', '0838912112'),
	('001', '0903123123'),
	('002', '0913454545'),
	('003', '0838121212'),
	('003', '0903656565'),
	('003', '0937125125'),
	('006', '0937888888'),
	('008', '0653717171'),
	('008', '0913232323')

-- DETAI
INSERT INTO DETAI
	(MADT,TENDT,CAPQL,KINHPHI,NGAYBD,NGAYKT,MACD,GVCNDT)
VALUES
	('001', N'HTTT QUẢN LÝ CÁC TRƯỜNG ĐH', N'ĐHQG', 20.0, '2007-10-20', '2008-10-20', N'QLGD', '002'),
	('002', N'HTTT QUẢN LÝ GIÁO VỤ CHO MỘT KHOA', N'TRƯỜNG', 20.0, '2000-10-12', '2001-10-12', N'QLGD', '002'),
	('003', N'NGHIÊN CỨU CHẾ TẠO SỢI NANÔ PLATIN', N'ĐHQG', 300.0, '2008-05-15', '2010-05-15', N'NCPT', '005'),
	('004', N'TẠO VẬT LIỆU SINH HỌC BẰNG MÀNG ỐI NGƯỜI', N'NHÀ NƯỚC', 100.0, '2007-01-01', '2009-12-31', N'NCPT', '004'),
	('005', N'ỨNG DỤNG HÓA HỌC XANH', N'TRƯỜNG', 200.0, '2003-10-10', '2004-12-10', N'UDCN', '007'),
	('006', N'NGHIÊN CỨU TẾ BÀO GỐC', N'NHÀ NƯỚC', 4000.0, '2006-10-12', '2009-10-12', N'NCPT', '004'),
	('007', N'HTTT QUẢN LÝ THƯ VIỆN Ở CÁC TRƯỜNG ĐH', N'TRƯỜNG', 20.0, '2009-05-10', '2010-05-10', N'QLGD', '001')

-- KHOA
INSERT INTO KHOA
	(MAKHOA,TENKHOA,NAMTL,PHONG,DIENTHOAI,TRUONGKHOA,NGAYNHANCHUC)
VALUES
	(N'CNTT', N'CÔNG NGHỆ THÔNG TIN', 1995, 'B11', '0838123456', '002', '2005-02-20'),
	(N'HH', N'HÓA HỌC', 1980, 'B41', '0838456456', '007', '2001-10-15'),
	(N'SH', N'SINH HỌC', 1980, 'B31', '0838454545', '004', '2000-10-11'),
	(N'VL', N'VẬT LÝ', 1976, 'B21', '0838223223', '005', '2003-09-18')

-- THAMGIADT
INSERT INTO THAMGIADT
	(MAGV,MADT,STT,PHUCAP, KETQUA)
VALUES
	('001', '002', 1, 0.0, NULL),
	('001', '002', 2, 2.0, NULL),
	('002', '001', 4 , 2.0, N'ĐẠT'),
	('003', '001', 1, 1.0, N'ĐẠT'),
	('003', '001', 2, 0.0, N'ĐẠT'),
	('003', '001', 4, 1.0, N'ĐẠT'),
	('003', '002', 2, 0.0, NULL),
	('004', '006', 1, 0.0, N'ĐẠT'),
	('004', '006', 2, 1.0, N'ĐẠT'),
	('006', '006', 2, 1.5, N'ĐẠT'),
	('009', '002', 3, 0.5, NULL),
	('009', '002', 4, 1.5, NULL)

-- NGUOITHAN
INSERT INTO NGUOITHAN
	(MAGV,TEN,NGSINH,PHAI)
VALUES
	('001', N'HÙNG', '1990-01-14', N'NAM'),
	('001', N'THỦY', '1994-12-08', N'NỮ'),
	('003', N'HÀ', '1998-09-03', N'NỮ'),
	('003', N'THU', '1998-09-03', N'NỮ'),
	('007', N'MAI', '2003-03-26', N'NỮ'),
	('007', N'VY', '2000-02-14', N'NỮ'),
	('008', N'NAM', '1991-05-06', N'NAM'),
	('009', N'AN', '1996-08-19', N'NAM'),
	('010', N'NGUYỆT', '2006-01-14', N'NỮ')

-- CONGVIEN
INSERT INTO CONGVIEC
	(MADT,SOTT,TENCV,NGAYBD,NGAYKT)
VALUES
	('001', 1, N'KHỞI TẠO VÀ LẬP KẾ HOẠCH', '2007-10-20', '2008-12-20'),
	('001', 2, N'XÁC ĐỊNH YÊU CẦU', '2008-12-21', '2008-03-21'),
	('001', 3, N'PHÂN TÍCH HỆ THỐNG', '2008-03-22', '2008-05-22'),
	('001', 4, N'THIẾT KẾ HỆ THỐNG', '2008-05-23', '2008-06-23'),
	('001', 5, N'CÀI ĐẶT THỬ NGHIỆM', '2008-06-24', '2008-10-20'),
	('002', 1, N'KHỞI TẠO VÀ LẬP KẾ HOẠCH', '2009-05-10', '2009-07-10'),
	('002', 2, N'XÁC ĐỊNH YÊU CẦU', '2009-07-11', '2009-10-11'),
	('002', 3, N'PHÂN TÍCH HỆ THỐNG', '2009-10-12', '2009-12-20'),
	('002', 4, N'THIẾT KẾ HỆ THỐNG', '2009-12-21', '2010-03-22'),
	('002', 5, N'CÀI ĐẶT THỬ NGHIỆM', '2010-03-23', '2010-05-10'),
	('006', 1, N'LẤY MẪU', '2006-10-20', '2007-02-20'),
	('006', 2, N'NUÔI CẤY', '2007-02-21', '2008-09-21')

-- ADD FOREIGN KEY 

-- GIAOVIEN
ALTER TABLE GIAOVIEN 
ADD CONSTRAINT FK_GV_GVQLCM 
FOREIGN KEY (GVQLCM) REFERENCES GIAOVIEN(MAGV)

ALTER TABLE GIAOVIEN 
ADD CONSTRAINT FK_GV_MABM
FOREIGN KEY (MABM) REFERENCES BOMON(MABM)

-- BOMON
ALTER TABLE BOMON 
ADD CONSTRAINT FK_BM_TRUONGBM 
FOREIGN KEY (TRUONGBM) REFERENCES GIAOVIEN(MAGV)

ALTER TABLE BOMON 
ADD CONSTRAINT FK_BM_MAKHOA 
FOREIGN KEY (MAKHOA) REFERENCES KHOA(MAKHOA)

-- KHOA
ALTER TABLE KHOA 
ADD CONSTRAINT FK_KHOA_TRUONGKHOA 
FOREIGN KEY (TRUONGKHOA) REFERENCES GIAOVIEN(MAGV)

-- DETAI
ALTER TABLE DETAI 
ADD CONSTRAINT FK_DT_MACD 
FOREIGN KEY (MACD) REFERENCES CHUDE(MACD)

ALTER TABLE DETAI 
ADD CONSTRAINT FK_DT_GVCNDT 
FOREIGN KEY (GVCNDT) REFERENCES GIAOVIEN(MAGV)

-- CONGVIEC
ALTER TABLE CONGVIEC 
ADD CONSTRAINT FK_CV_MADT 
FOREIGN KEY (MADT) REFERENCES DETAI(MADT)

-- THAMGIADT
ALTER TABLE THAMGIADT 
ADD CONSTRAINT FK_TGDT_MADT_SOTT
FOREIGN KEY (MADT, STT) REFERENCES CONGVIEC(MADT, SOTT)

ALTER TABLE THAMGIADT 
ADD CONSTRAINT FK_TGDT_MAGV
FOREIGN KEY (MAGV) REFERENCES GIAOVIEN(MAGV)

-- NGUOITHAN
ALTER TABLE NGUOITHAN 
ADD CONSTRAINT FK_NT_MAGV
FOREIGN KEY (MAGV) REFERENCES GIAOVIEN(MAGV)

-- GV_DT
ALTER TABLE GV_DT 
ADD CONSTRAINT FK_GVDT_MAGV
FOREIGN KEY (MAGV) REFERENCES GIAOVIEN(MAGV)











